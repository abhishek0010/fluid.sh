pre-commit:
  parallel: false
  commands:
    # Go - fluid CLI
    fmt-fluid-cli:
      glob: "*.go"
      root: "fluid-cli"
      run: gofumpt -w .
      stage_fixed: true

    # Go - fluid daemon
    fmt-fluid-daemon:
      glob: "*.go"
      root: "fluid-daemon"
      run: go fmt ./...
      stage_fixed: true

    # Go - API
    fmt-api:
      glob: "*.go"
      root: "api"
      run: go fmt ./...
      stage_fixed: true

    # Python SDK
    fmt-sdk-black:
      glob: "*.py"
      root: "sdk/fluid-py"
      run: black .
      stage_fixed: true

    fmt-sdk-isort:
      glob: "*.py"
      root: "sdk/fluid-py"
      run: isort .
      stage_fixed: true

    # Web
    fmt-web:
      glob: "*.{ts,tsx,js,jsx,json,css,md}"
      root: "web"
      run: bun format
      stage_fixed: true

pre-push:
  parallel: true
  commands:
    # Go - fluid CLI
    vet-fluid-cli:
      glob: "*.go"
      root: "fluid-cli"
      run: make vet

    test-fluid-cli:
      glob: "*.go"
      root: "fluid-cli"
      run: make test

    lint-fluid-cli:
      glob: "*.go"
      root: "fluid-cli"
      run: make lint

    # Go - fluid daemon
    vet-fluid-daemon:
      glob: "*.go"
      root: "fluid-daemon"
      run: make vet

    test-fluid-daemon:
      glob: "*.go"
      root: "fluid-daemon"
      run: make test

    lint-fluid-daemon:
      glob: "*.go"
      root: "fluid-daemon"
      run: make lint

    # Go - API
    vet-api:
      glob: "*.go"
      root: "api"
      run: make vet

    test-api:
      glob: "*.go"
      root: "api"
      run: make test

    lint-api:
      glob: "*.go"
      root: "api"
      run: make lint

    # Python SDK
    test-sdk:
      glob: "*.py"
      root: "sdk/fluid-py"
      run: python3 -m pytest test/ -v --tb=short

    # Web
    lint-web:
      glob: "*.ts"
      root: "web"
      run: bun lint

    typecheck-web:
      glob: "*.ts"
      root: "web"
      run: bun typecheck

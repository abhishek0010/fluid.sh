---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<BaseLayout
  title="Blog - fluid.sh"
  description="Updates from the fluid.sh team"
>
  <div class="min-h-screen text-white bg-black">
    <header class="px-6 pt-24 pb-12">
      <div class="mx-auto max-w-2xl">
        <div class="flex justify-between items-center mb-6">
          <div class="flex gap-3 items-center">
            <a
              href="/"
              class="text-2xl tracking-tight md:text-3xl font-logo no-underline hover:no-underline"
            >
              <span class="text-blue-400">$</span>
              <span class="text-white">fluid.sh</span>
            </a>
          </div>
          <div class="flex gap-6 text-sm font-mono text-neutral-400">
            <a href="/blog" class="text-neutral-200">Blog</a>
            <a
              href="https://github.com/aspectrr/fluid.sh"
              target="_blank"
              rel="noopener noreferrer"
              class="hover:text-neutral-200 transition-colors">GitHub</a
            >
            <a
              href="https://discord.gg/4WGGXJWm8J"
              target="_blank"
              rel="noopener noreferrer"
              class="hover:text-neutral-200 transition-colors">Discord</a
            >
          </div>
        </div>
      </div>
    </header>

    <main class="px-6 pb-24">
      <div class="mx-auto max-w-2xl space-y-3">
        {
          posts.map((post) => (
            <a
              href={`/blog/${post.slug}`}
              class="block p-4 rounded-lg bg-neutral-900/50 border border-neutral-800 hover:border-blue-500/30 transition-all duration-300 no-underline hover:no-underline group"
            >
              <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2">
                <h2 class="text-neutral-200 group-hover:text-blue-400 transition-colors font-mono text-sm">
                  {post.data.title}
                </h2>
                <time
                  datetime={post.data.pubDate.toISOString()}
                  class="text-xs font-mono text-neutral-600 whitespace-nowrap"
                >
                  {post.data.pubDate.toLocaleDateString("en-us", {
                    year: "numeric",
                    month: "short",
                    day: "numeric",
                  })}
                </time>
              </div>
              <p class="mt-2 text-sm text-neutral-500 line-clamp-2">
                {post.data.description}
              </p>
              {post.data.author && (
                <div class="mt-3 flex items-center gap-2">
                  {post.data.authorImage ? (
                    <img
                      src={`/images/${post.data.authorImage.split("/").pop()}`}
                      alt={post.data.author}
                      class="w-5 h-5 rounded-full border border-neutral-700"
                    />
                  ) : (
                    <div class="w-5 h-5 rounded-full bg-neutral-800 border border-neutral-700 flex items-center justify-center text-[10px] text-blue-400 font-mono">
                      {post.data.author.charAt(0)}
                    </div>
                  )}
                  <span class="text-xs font-mono text-neutral-600">
                    {post.data.author}
                  </span>
                </div>
              )}
            </a>
          ))
        }
      </div>
    </main>
  </div>
</BaseLayout>

<style>
  a {
    text-decoration: none !important;
  }
</style>
